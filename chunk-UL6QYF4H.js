import{a as Pe,b as Le,c as D}from"./chunk-OWPVGQ3L.js";import{a as Q,b as ve,c as he,d as Me,e as De}from"./chunk-ACCWHLXM.js";import{A as Ee,B as Fe,b as ce,c as me,i as de,l as pe,m as ue,n as z,o as fe,p as ge,q as ye,r as Se,s as _e,t as Ce,u as be,v as Re,w as xe,x as Ie,y as we,z as Te}from"./chunk-SP2BME5M.js";import{b as _}from"./chunk-L3OHN5FL.js";import{a as Z}from"./chunk-VKBCP5J6.js";import{b as O,c as M,e as N,f as V,k as U,m as $,n as B,r as G,s as H,t as q,u as le,v as se}from"./chunk-O6ZXFWJR.js";import{c as ne,k as ae,m as v,o as te}from"./chunk-VM527ZQ7.js";import{$b as w,Ba as C,Ca as j,Kb as u,La as g,Mb as d,Vb as a,Wb as l,Xb as y,Yb as A,Zb as k,cc as S,ec as f,hd as E,id as F,jc as W,kc as X,lc as Y,mb as s,mc as ie,nb as p,nc as m,oc as ee,od as oe,pc as b,ra as T,sa as L,ua as x,va as I,wc as re}from"./chunk-DOLGZFZY.js";var J=(()=>{let e=class e{constructor(i){this._http=i,this.URL="http://localhost:3000/privileges"}getPrivileges(){return this._http.get(this.URL)}};e.\u0275fac=function(r){return new(r||e)(g(ne))},e.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function qe(t,e){t&1&&(a(0,"div")(1,"span",18),m(2,"Role Title must contain only uppercase and lowercase letters."),l()())}function ze(t,e){if(t&1){let c=w();a(0,"div")(1,"label",19)(2,"input",20),S("change",function(r){let n=x(c).$implicit,h=f();return I(h.onprivilegeSelect(n,r))}),l(),m(3),l()()}if(t&2){let c=e.$implicit;s(3),b(" ",c.name," ")}}var Oe=(()=>{let e=class e{constructor(i,r,o,n,h){this.privilegeService=i,this.roleService=r,this.formBuilder=o,this.router=n,this.encryptionService=h,this.privileges=[],this.selectedPrivileges=[],this.myForm=this.formBuilder.group({roleTitle:["",[M.pattern("[a-zA-Z]+"),M.required]]})}onprivilegeSelect(i,r){if(r.target.checked)this.selectedPrivileges.push(i);else{let o=this.selectedPrivileges.indexOf(i);o!==-1&&this.selectedPrivileges.splice(o,1)}}ngOnInit(){this.getPrivileges()}getPrivileges(){this.privilegeService.getPrivileges().subscribe(i=>{this.privileges=i},i=>{})}onSubmit(){let i=this.myForm.get("roleTitle")?.value,r=this.selectedPrivileges.map(n=>n.id),o={name:i.toUpperCase(),privileges:r};this.roleService.addRole(o).subscribe(n=>{let h=localStorage.getItem("authorities");this.encryptionService.decrypt(h,"2f7").includes("READ::ROLE")?this.router.navigate(["/home/roles"]):this.router.navigate(["/home"])},n=>{})}};e.\u0275fac=function(r){return new(r||e)(p(J),p(D),p(q),p(v),p(_))},e.\u0275cmp=T({type:e,selectors:[["app-add-role"]],decls:21,vars:4,consts:[[1,"pcoded-main-container"],[1,"pcoded-wrapper"],[1,"pcoded-content"],[1,"pcoded-inner-content"],[1,"main-body"],[1,"page-wrapper"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"mb-9",3,"formGroup","ngSubmit"],[1,"form-floating"],["type","text","id","roleTitle","formControlName","roleTitle","pattern","[A-Za-z]+","required","","placeholder","ROLE TITLE",1,"form-control"],["for","roleTitle"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"error-message"],[1,"checkbox-label"],["type","checkbox",1,"styled-checkbox",3,"change"]],template:function(r,o){if(r&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"h5"),m(11,"Create Role"),l()(),a(12,"div",10)(13,"form",11),S("ngSubmit",function(){return o.onSubmit()}),a(14,"div",12),y(15,"input",13)(16,"label",14),u(17,qe,3,0,"div",15),l(),u(18,ze,4,1,"div",16),a(19,"button",17),m(20," Add "),l()()()()()()()()()()()()),r&2){let n;s(13),d("formGroup",o.myForm),s(4),d("ngIf",((n=o.myForm.get("roleTitle"))==null?null:n.invalid)&&(((n=o.myForm.get("roleTitle"))==null?null:n.dirty)||((n=o.myForm.get("roleTitle"))==null?null:n.touched))),s(),d("ngForOf",o.privileges),s(),d("disabled",o.myForm.invalid)}},dependencies:[E,F,U,O,N,V,G,H,$,B],styles:[".error-message[_ngcontent-%COMP%]{color:red}"]});let t=e;return t})();function Qe(t,e){t&1&&(a(0,"div")(1,"span",18),m(2,"Role Title must contain only uppercase and lowercase letters."),l()())}function Ze(t,e){if(t&1){let c=w();a(0,"div")(1,"label",19)(2,"input",20),S("change",function(r){let n=x(c).$implicit,h=f();return I(h.onPrivilegeSelect(n,r))}),l(),m(3),l()()}if(t&2){let c=e.$implicit,i=f();s(2),d("checked",i.isSelected(c)),s(),b(" ",c.name," ")}}var Ne=(()=>{let e=class e{constructor(i,r,o,n,h){this.router=i,this.fb=r,this.roleService=o,this.privilegeService=n,this.route=h,this.selectedPrivileges=[],this.privileges=[],this.myForm=this.fb.group({roleTitle:["",[M.pattern("[a-zA-Z]+"),M.required]]})}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),this.getRoleById(this.id),this.getPrivileges()}getPrivileges(){this.privilegeService.getPrivileges().subscribe(i=>{this.privileges=i,this.myForm.patchValue({id:this.role.id,roleTitle:this.role.name})},i=>{})}getRoleById(i){this.roleService.getRoleById(i).subscribe({next:r=>{this.role=r,this.selectedPrivileges=this.role.privilegeId,this.myForm.patchValue({roleTitle:this.role.name})},error:r=>{}})}isSelected(i){return this.selectedPrivileges.includes(i.id)}onPrivilegeSelect(i,r){if(r.target.checked)this.selectedPrivileges.push(i.id);else{let o=this.selectedPrivileges.indexOf(i.id);o!==-1&&this.selectedPrivileges.splice(o,1)}}onSubmit(){let i=this.myForm.get("roleTitle")?.value,r={id:this.id,name:i.toUpperCase(),privilegeId:this.selectedPrivileges};this.roleService.updateRole(r.id,r).subscribe(o=>{this.router.navigate(["/home/roles"])},o=>{})}};e.\u0275fac=function(r){return new(r||e)(p(v),p(q),p(D),p(J),p(ae))},e.\u0275cmp=T({type:e,selectors:[["app-update-role"]],decls:21,vars:4,consts:[[1,"pcoded-main-container"],[1,"pcoded-wrapper"],[1,"pcoded-content"],[1,"pcoded-inner-content"],[1,"main-body"],[1,"page-wrapper"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"mb-9",3,"formGroup","ngSubmit"],[1,"form-floating"],["type","text","id","roleTitle","formControlName","roleTitle","pattern","[A-Za-z]+","required","","placeholder","ROLE TITLE",1,"form-control"],["for","roleTitle"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"error-message"],[1,"checkbox-label"],["type","checkbox",1,"styled-checkbox",3,"checked","change"]],template:function(r,o){if(r&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"h5"),m(11,"Update Role"),l()(),a(12,"div",10)(13,"form",11),S("ngSubmit",function(){return o.onSubmit()}),a(14,"div",12),y(15,"input",13)(16,"label",14),u(17,Qe,3,0,"div",15),l(),u(18,Ze,4,2,"div",16),a(19,"button",17),m(20," Update "),l()()()()()()()()()()()()),r&2){let n;s(13),d("formGroup",o.myForm),s(4),d("ngIf",((n=o.myForm.get("roleTitle"))==null?null:n.invalid)&&(((n=o.myForm.get("roleTitle"))==null?null:n.dirty)||((n=o.myForm.get("roleTitle"))==null?null:n.touched))),s(),d("ngForOf",o.privileges),s(),d("disabled",o.myForm.invalid||o.selectedPrivileges.length===0)}},dependencies:[E,F,U,O,N,V,G,H,$,B],styles:[".error-message[_ngcontent-%COMP%]{color:red}"]});let t=e;return t})();function Je(t,e){if(t&1&&(a(0,"td",30),m(1),l()),t&2){let c=e.$implicit;s(),ee(c.id)}}function Ke(t,e){t&1&&(a(0,"th",31),m(1,"Role"),l())}function We(t,e){if(t&1&&(a(0,"td",30),m(1),l()),t&2){let c=e.$implicit;s(),ee(c.name)}}function Xe(t,e){t&1&&(a(0,"th",31),m(1," Privileges "),l())}function Ye(t,e){if(t&1&&(a(0,"span"),m(1),y(2,"br"),l()),t&2){let c=e.$implicit;s(),b(" ",c.name," ")}}function et(t,e){if(t&1&&(a(0,"td",30),u(1,Ye,3,1,"span",32),l()),t&2){let c=e.$implicit;s(),d("ngForOf",c.privileges)}}function tt(t,e){t&1&&(a(0,"th",31),m(1," Actions "),l())}function it(t,e){if(t&1){let c=w();a(0,"button",35),S("click",function(){x(c);let r=f().$implicit,o=f();return I(o.onEditClick(r.id))}),a(1,"mat-icon"),m(2,"edit"),l()()}}function rt(t,e){if(t&1){let c=w();a(0,"button",36),S("click",function(){x(c);let r=f().$implicit,o=f();return I(o.delete(r.id))}),a(1,"mat-icon"),m(2,"delete"),l()()}}function ot(t,e){if(t&1&&(a(0,"td",30),u(1,it,3,0,"button",33)(2,rt,3,0,"button",34),l()),t&2){let c=f();s(),d("ngIf",c.updateRole),s(),d("ngIf",c.deleteRole)}}function nt(t,e){t&1&&y(0,"tr",37)}function at(t,e){t&1&&y(0,"tr",38)}function lt(t,e){if(t&1&&(a(0,"tr",39)(1,"td",40),m(2),l()()),t&2){f();let c=ie(23);s(2),b(' No data matching the filter "',c.value,'" ')}}var st=()=>[5,10,25,100],Ve=(()=>{let e=class e{ngOnInit(){let i=localStorage.getItem("authorities");this.authorities=this.encryptionService.decrypt(i,"2f7"),this.authorities.includes("EDIT::ROLE")&&(this.updateRole=!0),this.authorities.includes("DELETE::ROLE")&&(this.deleteRole=!0),this.getRoles()}constructor(i,r,o){this.router=i,this.roleService=r,this.encryptionService=o,this.displayedColumns=["Role","Privileges","Actions"],this.authorities="",this.updateRole=!1,this.deleteRole=!1,this.roles=0}applyFilter(i){let r=i.target.value;this.dataSource.filter=r.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getRoles(){this.roleService.getRoles().subscribe({next:i=>{i.reverse(),this.roles=i.length,this.dataSource=new Fe(i),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator},error:i=>{}})}onEditClick(i){this.router.navigate(["/home/roles/update/"+i])}delete(i){this.roleService.deleteRole(i).subscribe({next:r=>{this.getRoles()},error:console.log})}};e.\u0275fac=function(r){return new(r||e)(p(v),p(D),p(_))},e.\u0275cmp=T({type:e,selectors:[["app-list-role"]],viewQuery:function(r,o){if(r&1&&(W(z,5),W(Q,5)),r&2){let n;X(n=Y())&&(o.paginator=n.first),X(n=Y())&&(o.sort=n.first)}},decls:40,vars:6,consts:[[1,"pcoded-main-container"],[1,"pcoded-wrapper"],[1,"pcoded-content"],[1,"pcoded-inner-content"],[1,"main-body"],[1,"row"],[1,"col-md-6","col-xl-4"],[1,"card","daily-sales"],[1,"card-block"],[1,"row","d-flex","align-items-center"],[1,"col-12"],[1,"f-w-300","d-flex","align-items-center","m-b-0"],[1,"feather","icon-settings","text-c-green","f-40","m-r-20"],[1,"text-c-purple","mb-0"],[1,"text-muted"],[1,"progress","m-t-30",2,"height","7px"],["role","progressbar","aria-valuenow","50","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-c-theme",2,"width","100%"],["matInput","","placeholder","Ex. ADMIN",3,"keyup"],["input",""],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["mat-cell","",4,"matCellDef"],["matColumnDef","Role"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","Privileges"],["matColumnDef","Actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],[4,"ngFor","ngForOf"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","","color","warn",3,"click",4,"ngIf"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(r,o){r&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"h3",11),y(12,"i",12),a(13,"h3",13),m(14,"Total Roles "),a(15,"span",14),m(16),l()()()()(),a(17,"div",15),y(18,"div",16),l()()()()(),a(19,"mat-form-field")(20,"mat-label"),m(21,"Filter"),l(),a(22,"input",17,18),S("keyup",function(h){return o.applyFilter(h)}),l()(),a(24,"div",19)(25,"table",20),u(26,Je,2,1,"td",21),A(27,22),u(28,Ke,2,0,"th",23)(29,We,2,1,"td",21),k(),A(30,24),u(31,Xe,2,0,"th",23)(32,et,2,1,"td",21),k(),A(33,25),u(34,tt,2,0,"th",23)(35,ot,3,2,"td",21),k(),u(36,nt,1,0,"tr",26)(37,at,1,0,"tr",27)(38,lt,3,1,"tr",28),l(),y(39,"mat-paginator",29),l()()()()()()),r&2&&(s(16),b("\xA0\xA0 ",o.roles," "),s(9),d("dataSource",o.dataSource),s(11),d("matHeaderRowDef",o.displayedColumns),s(),d("matRowDefColumns",o.displayedColumns),s(2),d("pageSizeOptions",re(5,st)))},dependencies:[E,F,ge,Se,Re,_e,ye,xe,Ce,be,Ie,we,Te,z,Q,ve,Me,pe,de,Pe,ce],styles:[".visually-hidden[_ngcontent-%COMP%]{position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden}"]});let t=e;return t})();var Ue=(()=>{let e=class e{constructor(i,r){this.encryptionService=i,this.router=r}canActivate(i,r){let o=localStorage.getItem("authorities");return this.encryptionService.decrypt(o,"2f7").includes("READ::ROLE")?!0:(this.router.navigate(["/notfound"]),!1)}};e.\u0275fac=function(r){return new(r||e)(g(_),g(v))},e.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var $e=(()=>{let e=class e{constructor(i,r){this.encryptionService=i,this.router=r}canActivate(i,r){let o=localStorage.getItem("authorities");return this.encryptionService.decrypt(o,"2f7").includes("ADD::ROLE")?!0:(this.router.navigate(["/notfound"]),!1)}};e.\u0275fac=function(r){return new(r||e)(g(_),g(v))},e.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Be=(()=>{let e=class e{constructor(i,r){this.encryptionService=i,this.router=r}canActivate(i,r){let o=localStorage.getItem("authorities");return this.encryptionService.decrypt(o,"2f7").includes("EDIT::ROLE")?!0:(this.router.navigate(["/notfound"]),!1)}};e.\u0275fac=function(r){return new(r||e)(g(_),g(v))},e.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ct=[{path:"",component:Ve,canActivate:[Z,Ue]},{path:"add",component:Oe,canActivate:[Z,$e]},{path:"update/:id",component:Ne,canActivate:[Z,Be]}],Ge=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=L({type:e}),e.\u0275inj=j({imports:[te.forChild(ct),te]});let t=e;return t})();var ti=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=L({type:e}),e.\u0275inj=j({imports:[oe,Ge,le,se,Ee,fe,he,De,Le,ue,me]});let t=e;return t})();export{ti as a};
